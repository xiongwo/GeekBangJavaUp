ps：最近太忙，还没来得及搞成微服务，所以只能找回之前玩过的 spring boot 秒杀系统来修改

### Spring Boot 系统实现

#### 一、查询秒杀商品服务端

首先查询本地 Guava 缓存（缓存失效设置60秒），没有再查 redis 缓存（缓存失效设置10分钟），都没有，最后才查询数据库

一旦数据库库存更新了，就通过 MQ 广播通知各个服务端进行缓存刷新（系统没有实现）

#### 二、秒杀商品交易服务端

核心思路：扣减库存操作放到 redis 中，然后通过 MQ 异步扣减数据库库存

1. 关于限流，在下单前，引入验证码校验和根据秒杀商品的库存数量预估的限流器（Guava 的限流器）
2. 关于一致性，就是通过 Spring 事务管理、订单流水状态和 RocketMQ 的事务反查来实现



### 基于上面的 Spring Boot 系统改造成微服务系统的思路

一、服务注册与发现，可以使用 Nacos，并且搭配 Loadbalancer 实现客户端负载均衡

二、服务间调用，可以使用 OpenFeign，并搭配 Hystrix 实现轻量级的降级能力

三、配置中心，Nacos Config，在秒杀活动开始前，可以在后台管理系统触发开发，让秒杀系统进行预热，让数据预热到缓存中